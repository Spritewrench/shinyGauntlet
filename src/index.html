<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>shiny-gauntlet</title>

  <!-- build:css main.min.css -->
  <link rel="stylesheet" href="css/main.css"> 
  <link rel="stylesheet" href="css/stylesheet.css" type="text/css" charset="utf-8" />
  <!-- /build -->
</head>

<body>
  
  
  <div id="titleScreen">

    <br/>
    Dungeon Code:
    <input  id="seed" type="text" value="4400331612" readonly>
    <input id="clickMe" type="button" value="retry" onclick="retry();" />
    Item Code:
    <input type="text">  
    Difficulty:
    <div id="diff"></div>
    <input id="clickMe" type="button" value="Play" onclick="genDungeon();" />
  </div>





  <!-- build:js main.min.js -->
  <script>
    //gen dungeon seed
    retry();
    //respond to space press
    document.addEventListener('keydown', function(event) {
        if(event.keyCode == 32) {
            genDungeon();
        }

    });    
    //gen difficult
    var diff = localStorage.setItem("diff", 0 );

   
    function genDungeon(){

      var seed = document.getElementById('seed').value;
      
      localStorage.setItem("dungeonSeed", seed );  
      window.location.href = "game.html";
    }
    function retry(){
      
      var src = document.getElementsByTagName('img');
      for (var i= document.images.length; i-->0;){
        document.images[i].parentNode.removeChild(document.images[i]);  
      }      
   
      
      
      var diff = 0;
      var seed = "";
      var x = Math.floor((Math.random()*9)+1);
      var y = Math.floor((Math.random()*9)+1);
      var startX = Math.floor((Math.random()*x-1)+1);
      var startY = Math.floor((Math.random()*y-1)+1);
      var winX   = Math.floor((Math.random()*x-1)+1);
      var winY   = Math.floor((Math.random()*y-1)+1);
     
      
      //win pos check
      if(winX == startX){
        if(winX+1 > x || winX == x){
          winX -= 1;
        }
        else{
          winX += 1;
        }
      }
      if(winY == startY ){
        if(winY+1 > y || winY == y){
          winY -= 1;
        }
        else{
          winY += 1;
        }        
      }      
      
      seed += ""+x+y+startX+startY+winX+winY;
      var monNum = Math.floor((Math.random()*9)+1);
      var wepRate = 5;
      for(var i =0; i < monNum; i++){
         
        var wepCtrl = Math.floor((Math.random()*wepRate)+1);
        if(wepCtrl == 1){
          var monCode = ""+(Math.floor((Math.random()*3)+1)+5);
          wepRate = wepRate *10;
        }
        else{
          var monCode = ""+Math.floor((Math.random()*3)+1);
          diff++;
        }
        
        var monPrefix = ""+Math.floor((Math.random()*9)+1);
        seed += 4+monPrefix;
        
      }
      
      document.getElementById('seed').value = seed;
      document.getElementById('seed').style.width= (seed.length*10)+"px";
      
      for(var i = 0; i < diff; i++){
        var img = document.createElement("img");
        img.src = "assets/player.png";
        var src = document.getElementById("diff");
        src.appendChild(img);       
      }      

              
     
    }           

  </script>  
  
  <!-- /build -->
  

</body>
</html>

