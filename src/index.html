<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>shiny-gauntlet</title>

  <!-- build:css main.min.css -->
  <link rel="stylesheet" href="css/main.css"> 
  <link rel="stylesheet" href="css/stylesheet.css" type="text/css" charset="utf-8" />
  <script type="text/javascript" src="js/lib/jszip-utils.min.js"></script>
  <script type="text/javascript" src="js/lib/jszip.min.js"></script>
  <script type="text/javascript" src="js/lib/lz-string-1.3.3.js"></script>
  <!-- /build -->
</head>

<body>
  
  
  <div id="titleScreen">

    <br/>
    <br/>
    <br/>

    

    <div id="diff"></div>
    <input id="clickMe" type="button" value="Play" onclick="genDungeon();" />

    <input type="file" id="file" name="file" multiple=""><br>

    <div id="error_block" class="alert alert-danger hidden">

    </div>

    <div id="result_block" class="hidden">
      <div id="result"></div>
    </div>
    <script type="text/javascript" src="js/lib/jquery-1.11.1.min.js"></script>
    <script type="text/javascript">
    (function () {
      if (!window.FileReader || !window.ArrayBuffer) {
        $("#error_block").removeClass("hidden").addClass("show");
        return;
      }


      var $result = $("#result");
      $("#file").on("change", function(evt) {
        // remove content
        $result.html("");
        // be sure to show the results
        $("#result_block").removeClass("hidden").addClass("show");

        // see http://www.html5rocks.com/en/tutorials/file/dndfiles/

        var files = evt.target.files;
        for (var i = 0, f; f = files[i]; i++) {

          var reader = new FileReader();

          // Closure to capture the file information.
          reader.onload = (function(theFile) {
            return function(e) {

              $result.append($title);
              var $fileContent = $("<ul>");
              try {


                // read the content of the file with JSZip
                var zip = new JSZip(e.target.result);
                var string = zip.file("Dungeon.txt").asText();
                if(string.length > 0 ){
                  localStorage.setItem("validCode", true );
                }

                localStorage.setItem("continue",string);
                var string = LZString.decompress(string);
              } catch(e) {
                $fileContent = $("<div>", {
                  "class" : "alert alert-danger",
                  text : "Error reading " + theFile.name + " : " + e.message
                });
              }
              $
            }
          })(f);

          // read the file !
          // readAsArrayBuffer and readAsBinaryString both produce valid content for JSZip.
          reader.readAsArrayBuffer(f);
          // reader.readAsBinaryString(f);
        }
      });
    })();
    </script>
    <input id="clickMe" type="button" value="Continue" onclick="genDungeon2();" />






  <!-- build:js main.min.js -->
  <script type="text/javascript" src="js\lib\widgets.js"></script>
  <script>
    //numbers only
    
    //gen dungeon seed
    //retry();
    //respond to space press
    document.addEventListener('keydown', function(event) {
        if(event.keyCode == 32) {
            genDungeon();
        }

    });    
    //gen difficult
    var diff = localStorage.setItem("diff", 0 );

   
    function genDungeon(){


        localStorage.setItem("dungeonSeed", 0 );  
        window.location.href = "game.html";   
    }
    function genDungeon2(){
        
        var file = document.getElementById("file").value;

        localStorage.setItem("dungeonSeed", 0 );  
        if(file == ""){
          alert("Choose a File");
        }
        else if(!localStorage.getItem("validCode") ){
          alert("Uploaded document not valid!");
        }
        else{
          window.location.href = "continue.html"; 
        }
            
    }    

  
    



      
      



              
     
               

  </script>  
  
  <!-- /build -->
  

</body>
</html>

