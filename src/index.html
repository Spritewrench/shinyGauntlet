<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>shiny-gauntlet</title>

  <!-- build:css main.min.css -->
  <link rel="stylesheet" href="css/main.css"> 
  <link rel="stylesheet" href="css/stylesheet.css" type="text/css" charset="utf-8" />
  <!-- /build -->
</head>

<body>
  
  
  <div id="titleScreen">

    <br/>
    Dungeon Code:
    <input  id="seed" type="text" value="4400331612" readonly>
    <input id="clickMe" type="button" value="retry" onclick="retry();" />
    <a id ="tweet" href="https://twitter.com/intent/tweet?text=">
      test
    </a>
    
    <br/>
    
    Difficulty:
    <div id="diff"></div>
    <input id="clickMe" type="button" value="Play" onclick="genDungeon();" />
  </div>






  <!-- build:js main.min.js -->
  <script type="text/javascript" src="js\lib\widgets.js"></script>
  <script>
    //gen dungeon seed
    retry();
    //respond to space press
    document.addEventListener('keydown', function(event) {
        if(event.keyCode == 32) {
            genDungeon();
        }

    });    
    //gen difficult
    var diff = localStorage.setItem("diff", 0 );

   
    function genDungeon(){

      var seed = document.getElementById('seed').value;
      
      localStorage.setItem("dungeonSeed", seed );  
      window.location.href = "game.html";
    }
    function retry(){
      
      var src = document.getElementsByTagName('img');
      for (var i= document.images.length; i-->0;){
        document.images[i].parentNode.removeChild(document.images[i]);  
      }      
   
      
      
      var diff = 0;
      var seed = "";
      var x = Math.floor((Math.random()*9)+1);
      var y = Math.floor((Math.random()*9)+1);
      var startX = Math.floor((Math.random()*x-1)+1);
      var startY = Math.floor((Math.random()*y-1)+1);
      var winX   = Math.floor((Math.random()*x-1)+1);
      var winY   = Math.floor((Math.random()*y-1)+1);
     
      
      //win pos check
      if(winX == startX){
        if(winX+1 > x || winX == x){
          winX -= 1;
        }
        else{
          winX += 1;
        }
      }
      if(winY == startY ){
        if(winY+1 > y || winY == y){
          winY -= 1;
        }
        else{
          winY += 1;
        }        
      }      
      
      seed += ""+x+y+startX+startY+winX+winY;
      
      var mon1Type = Math.floor((Math.random()*8)+1);
      var mon2Type = Math.floor((Math.random()*8)+1);
      var mon3Type = Math.floor((Math.random()*8)+1);
      var mon4Type = Math.floor((Math.random()*8)+1);
      var mon5Type = Math.floor((Math.random()*8)+1);  
      
      var mon1Pref = Math.floor((Math.random()*9));
      var mon2Pref = Math.floor((Math.random()*9));
      var mon3Pref = Math.floor((Math.random()*9));
      var mon4Pref = Math.floor((Math.random()*9));
      var mon5Pref = Math.floor((Math.random()*9));
      var wep = (Math.floor((Math.random()*3)+1)+5);
      var wepPref =Math.floor((Math.random()*9));
      
      
       seed += ""+mon1Type+mon1Pref+mon2Type+mon2Pref+mon2Type+wep+wepPref+mon3Pref+mon4Type+mon4Pref+mon5Type+mon5Pref;
      
      diff = 3;
      
      document.getElementById('seed').value = seed;
      document.getElementById('tweet').href = "https://twitter.com/intent/tweet?text=Dungeon Code: "+seed+" Generated!&hashtags=shinygauntlet";
      document.getElementById('seed').style.width= (seed.length*10)+"px";
      
      for(var i = 0; i < diff; i++){
        var img = document.createElement("img");
        img.src = "assets/starBronze.png";
        var src = document.getElementById("diff");
        src.appendChild(img);       
      }      

              
     
    }           

  </script>  
  
  <!-- /build -->
  

</body>
</html>

